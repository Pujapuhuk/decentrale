<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Reserveren | De Centrale</title>
    <meta name="description" content="Je kunt bij ons gemakkelijk resereveren met dit formulier.">

    <!-- favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link id="bsdp-css" href="/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet">

    <!-- Style -->
    <link href="/style.css" rel="stylesheet">
    <link media="screen and (max-width: 480px)" href="/css/style480.css" rel="stylesheet">

    <!-- font -->
    <link href="https://fonts.googleapis.com/css?family=Gabriela" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Karla" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-36915461-3', 'auto');
      ga('send', 'pageview');
    </script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  </head>
  <body>
    <nav class="navbar fixed-top navbar-expand-lg navbar-light">
      <a class="navbar-brand js-scroll-trigger" href="/">DE CENTRALE</a>
      <button class="navbar-toggler custom-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        <span class="my-1 close">
          <svg fill="#000000" height="32" viewBox="0 0 24 24" width="32" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            <path d="M0 0h24v24H0z" fill="none"/>
          </svg>
        </span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a href="/menukaart/" class="nav-link page-scroll">Menukaart</a>
        </li>
        <li class="nav-item">
          <a href="/wijnkaart/" class="nav-link page-scroll">Wijnkaart</a>
        </li>
        <li class="nav-item">
          <a href="/groepen/" class="nav-link page-scroll">Groepen</a>
        </li>
        <li class="nav-item">
              <a href="/kunst/" class="nav-link page-scroll">Kunst</a>
            </li>
            <li class="nav-item">
              <a href="/vacatures/" class="nav-link page-scroll">Vacatures</a>
          </li>
          <li class="nav-item">
            <a href="/eigenvondst/" class="nav-link page-scroll">üç∑ Wijnshop</a>
          </li>
          <li class="nav-item nav-link-reserveer active-reserveer">
            <a class="nav-link page-scroll" href="/contact/">Reserveer</a>
          </li>
        </ul>
      </div>
    </nav>
    <div class="container-l page-title-contact d-block d-sm-none">
      <div class="page-title-text-wrap">
        <h5>Reserveer</h5>
      </div>
    </div>
    <!-- content-reserveren -->
    <div class="page-title-white container-s reserveren-content  d-none d-sm-block">

      <div class="page-title-text-wrap">
        <h1>RESERVEER</h1>
      </div>
    </div>
    <div class="container-s page-intro-text text-center reserveren-intro">
      <p>Reserveren voor het diner kan via onderstaand formulier. Let op! Je reservering staat
        pas vast als je een bevestigende e-mail van ons hebt ontvangen. Bel je liever?
        Doe dat dan tijdens onze openingstijden op <br>015-8892777.</p>
    </div>
    <div class="container-s">
      <div class="container-black">
        <p>Alles gereserveerd? Wij houden altijd een aantal tafels vrij voor de spontane bezoeker! </p>
      </div>
    </div>
    <div class="container-s">
      <form id="contact-form" method="post" action="/.netlify/functions/send-mail" autocomplete="off">
        <div class="controls">
          <div class="row">
            <div class="col-xs-12 col-md-8">
              <div class="form-group">
                <label for="form_date">Welke dag wil je komen?</label>
                <input id="form_date" name="date" type="text" class="form-control formnumber" placeholder="dd/mm/yyyy"  required="required" data-error="Selecteer een dag" />
                <div class="help-block with-errors"></div>
              </div>
            </div>
            <div class="col-xs-6 col-md-4">
              <div class="form-group">
                <label for="timeslots">Hoe laat? *</label>
                <div class="selectpicker">
                  <select id ="timeslots" name="time" class="form-control" required="required" data-error="Selecteer een tijd">
                    <option selected disabled value="">Kies een tijd</option>
                    <option value="17:30">17:30</option>
                    <option value="17:30">17:30</option>
                    <option value="18:00">18:00</option>
                    <option value="18:30">18:30</option>
                    <option value="19:00">19:00</option>
                    <option value="19:30">19:30</option>
                    <option value="20:00">20:00</option>
                    <option value="20:30">20:30</option>
                    <option value="21:00">21:00</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-xs-6 col-md-4">
              <div class="form-group">
                <label for="form_number">Hoeveel personen? *</label>
                <input id="form_number" name="number" type="number" class="formnumber form-control" placeholder="" min="1" required="required" data-error="Geef een aantal op." />
                <div class="help-block with-errors"></div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-12">
              <div class="form-group">
                <label for="form_message">Zijn er allergie√´n of andere eetwensen waar we rekening mee moeten houden?</label>
                <textarea id="form_message" name="message" class="form-control textarea-form" placeholder="" rows="4" data-error=""></textarea>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-8">
              <div class="form-group">
                <label for="form_name">Naam *</label>
                <input id="form_name" type="text" name="name" class="form-control" placeholder="" required="required" data-error="Vul een naam in.">
                <div class="help-block with-errors"></div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-8">
              <div class="form-group">
                <label for="form_email">Email adres *</label>
                <input id="form_email" type="email" name="email" class="form-control" placeholder="" required="required" data-error="Vul een geldig emailadres in.">
                <div class="help-block with-errors"></div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-8">
              <div class="form-group">
                <label for="form_phone">Telefoonnummer *</label>
                <input id="form_phone" type="tel" name="phone" class="form-control" placeholder="" required="required" data-error="Als je wilt reserveren hebben we een telefoonnummer nodig.">
                <div class="help-block with-errors"></div>
              </div>
            </div>
          </div>
          <div class="messages"></div>
          <div class="g-recaptcha" data-sitekey="6Lfe-9UUAAAAAMRzzLBpKmW2ewUFyGu44YvfHbJM" required="required" data-callback="correctCaptcha"></div>
      <br/>
          <input type="submit" class="btn btn-success btn-send btn-form" value="VERSTUUR" />
        </div>
      </form>
    </div>
    <footer class="container-l">
      <div class="row">
        <div class="footer-box col-md-3 text-center">
          <h6>Contact</h6>
          <p>015 - 889 27 77</p>
          <p>hallo@decentraledelft.nl</p>
        </div>
        <div class="footer-box col-md-3 text-center">
          <h6>Openingstijden</h6>
          <p>ma, wo, do, vr, za en zo open vanaf 17:30</p>
          <p>alleen dinsdag gesloten</p>
        </div>
        <div class="footer-box col-md-3 text-center">
          <h6>Locatie</h6>
          <p>Voldersgracht 2<br>2611 ET Delft</p>
          <a href="https://www.google.nl/maps/place/Voldersgracht+2,+2611+ET+Delft/@52.011741,4.355754,17z/data=!3m1!4b1!4m5!3m4!1s0x47c5b5c3b08304c5:0x79ad52aba43f8354!8m2!3d52.011741!4d4.357948" target="_blank" rel="noopener">
            Route
          </a>
        </div>
        <div class="col-md-3 text-center">
          <p><a href="https://www.facebook.com/decentraledelft" target="_blank" rel="noopener">Facebook</a></p>
          <p><a href="https://www.instagram.com/decentraledelft/" target="_blank" rel="noopener">Instagram</a></p>
        </div>
      </div>
    </footer>

    <script>
      /**
       * disable submit until recaptcha
       */
      $("form").each(function() {
    $(this).find(':input[type="submit"]').prop('disabled', true);
});
function correctCaptcha() {
    $("form").each(function() {
        $(this).find(':input[type="submit"]').prop('disabled', false);
    });
}
      /**
       * initialize Google Calendar API using our config.
       */
      function init() {
        const ApiConfig = {
          apiKey: 'AIzaSyAZNrZJmglPTHZphiJ80MmbD3stQGbbcJo',
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
        }
        gapi.client
          .init(ApiConfig)
          .then(() => requestCalendarEvents())
          .then((res) => parseResponseResult(res))
          .catch((err) => logError(err))
      }
      /**
       * request all events from the calendar.
       */
      function requestCalendarEvents() {
        const date = getSelectedDate()
        const timeMin = dayjs(date).toString()
        const timeMax = dayjs(date).add(1, 'day').subtract(1, 'second').toString()
        const requestConfig = {
          calendarId: '0pbhpkd9b1qik41539d52vu3ko@group.calendar.google.com',
          alwaysIncludeEmail: false,
          orderBy: 'startTime',
          singleEvents: true,
          timeMin: formatDate(timeMin, 'YYYY-MM-DDTHH:mm:ss[Z]'),
          timeMax: formatDate(timeMax, 'YYYY-MM-DDTHH:mm:ss[Z]'),
        }
        return gapi.client.calendar.events.list(requestConfig)
      }
      /**
       * parse the received response, and update the timeslots on the page.
       */
      function parseResponseResult(data) {
        const body = JSON.parse(data.body)
        if (body.items) {
          updateTimeslots(body.items)
        }
      }
      /**
       * compare the received events times with the timeslots
       * if a match is found, the corresponding timeslot is disabled.
       */
      function updateTimeslots(items) {
        const selectElement = document.getElementById('timeslots')
        const timeslots = [...selectElement.children]
        const offset = -(new Date().getTimezoneOffset() / 60)
        const events = formatEvents(items)
        const selectedDate = getSelectedDate()
        /*const disabledDayOfWeek = dayjs(selectedDate).day() === 2 // 2 = Tuesday
        disabledDayOfWeek
          ? selectElement.disabled = true
          : selectElement.disabled = false
        /* Remove selected and disabled attributes and reset the slot innerHTML */
        timeslots.map(slot => {
          slot.disabled = false
          slot.selected = false
          slot.innerHTML = slot.value
        })
        /* if timeslot falls between the start time and end time of a calendar event
        we disable that timeslot and add '(vol)' after the value */
        timeslots.map(slot => {
          const dateTime = formatDate(`${selectedDate}T${slot.value}`, 'YYYY-MM-DDTHH:mm:ss[Z]')
          const slotStartTime = dayjs(dateTime).unix()
          const slotEndTime = dayjs(dateTime).add(1, 'minute').unix()
          const match = events.find((event) =>
            slotStartTime >= dayjs(event.startTime).unix() &&
            slotEndTime <= dayjs(event.endTime).unix()
          )
          if (match) {
            slot.disabled = true
            slot.selected = false
            slot.innerHTML = `${slot.value} (vol)`
          }
        })
      }
      /**
       * Get the selected date.
       * Returns date with format: mm/dd/yyyy
       */
      function getSelectedDate() {
        const date = document.getElementById('form_date').value.split('-')
        const newDate = [date[2], date[1], date[0]].join('-')
        return formatDate(newDate, 'YYYY-MM-DD')
      }
      /**
       * Return a date string in a specified format.
       */
      function formatDate(date, format) {
        const parsedDate = dayjs(date).toDate()
        return dayjs(parsedDate).format(format).toString()
      }
      /**
       * Format the received calendar events to only contain
       * the necessary data we need.
       */
      function formatEvents(items) {
        return items.map((item) => ({
          id: item.id,
          startTime: formatDate(item.start.dateTime, 'YYYY-MM-DDTHH:mm:ss[Z]'),
          endTime: formatDate(item.end.dateTime, 'YYYY-MM-DDTHH:mm:ss[Z]'),
        }))
      }
      /**
       * Log any API errors
       * format: error code, message
       */
      function logError(reason) {
        const { error } = reason.result
        console.error(error.code, error.message)
      }
      /**
       * Start loading the Google API Client.
       */
      function initApiClient() {
        gapi.load('client', init)
      }
    </script>

    <!-- Google API Client -->
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};initApiClient()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="/js/jquery.1.11.1.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script src="/bootstrap-datepicker/locales/bootstrap-datepicker.nl.min.js"></script>

    <!-- Error message in form -->
    <script src="/js/validator.js"></script>

    <!-- Validator on form -->
    <script src="/js/contact.js"></script>

    <!-- DayJS -->
    <script src="/js/dayjs.min.js"></script>

    <script>
      $(document).ready(() => {
        const datepickerConfig = {
          weekStart: 1,
          daysOfWeekDisabled: '2',
          datesDisabled: [],
          autoclose: true,
          format: 'dd-mm-yyyy',
          startDate: '+0d',
          language: 'nl',
          todayHighlight: true,
        }
        // initialize datepicker
        $('#form_date')
          .datepicker(datepickerConfig)
          .datepicker('setDate', new Date())
          .on('changeDate', () => {
            initApiClient()
          })
      })
    </script>
  </body>
  </html>
